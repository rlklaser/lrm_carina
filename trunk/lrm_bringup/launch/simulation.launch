<launch>

<!-- 
	<param if="$(env RUN_SIMULATED)"
		name="/use_sim_time"
		value="true" />
 -->

	<param
		name="/use_sim_time"
		value="true" />

	<env
		name="GAZEBO_MODEL_PATH"
		value="$GAZEBO_MODEL_PATH:$(find lrm_description)/models:$(find lrm_description)/models/trees" />
	<env
		name="GAZEBO_PLUGIN_PATH"
		value="$GAZEBO_PLUGIN_PATH:$(find lrm_gazebo)/lib" />

	<group ns="/stereo">
		<rosparam
			command="load"
			file="$(find lrm_description)/params/sensors_parameters.yaml" />
	</group>

	<rosparam
		command="load"
		file="$(find lrm_gazebo)/params/carina_4w_suspension.yaml" />

	<node
		name="carina_object"
		pkg="gazebo"
		type="spawn_model"
		args="-urdf -param robot_description -x -1.0 -y 0.0 -z 0.05 -R 0 -P 0 -Y 0 -model carina -gazebo_namespace /gazebo -unpause"
		respawn="false"
		output="screen" />

	<node
		pkg="tf"
		type="static_transform_publisher"
		name="ground_truth_odom_broadcaster"
		args="0 0 0 0 0 0 map odom_gazebo 30"
		output="screen"
		respawn="true" />

	<node
		name="front_left_susp_controller"
		pkg="pr2_controller_manager"
		type="spawner"
		args="front_left_susp_controller"
		respawn="true"
		output="screen" />

	<node
		name="front_right_susp_controller"
		pkg="pr2_controller_manager"
		type="spawner"
		args="front_right_susp_controller"
		respawn="true"
		output="screen" />

	<node
		name="rear_left_susp_controller"
		pkg="pr2_controller_manager"
		type="spawner"
		args="rear_left_susp_controller"
		respawn="true"
		output="screen" />

	<node
		name="rear_right_susp_controller"
		pkg="pr2_controller_manager"
		type="spawner"
		args="rear_right_susp_controller"
		respawn="true"
		output="screen" />

	<node
		name="encoders_controller"
		pkg="pr2_controller_manager"
		type="spawner"
		args="encoders_controller"
		respawn="true"
		output="screen"
	>
		<param
			name="type"
			value="lrm_gazebo/EncodersControllerPlugin" />
		<param
			name="steering_wheel"
			value="true" />
		<param
			name="update_rate"
			value="30" />
		<param
			name="wheel_encoder_joint"
			value="joint_front_right_wheel" />
		<param
			name="steering_encoder_joint"
			value="joint_steer" />
		<param
			name="steering_wheel_joint"
			value="joint_steering_wheel" />
	</node>

<!-- 
	<node
		name="carina_controller"
		pkg="pr2_controller_manager"
		type="spawner"
		args="carina_controller"
		respawn="false"
		output="screen"
	>
		<param
			name="type"
			value="lrm_controller/CarinaControllerPlugin" />
		<param
			name="timeout"
			value="5" />
		<param
			name="wheel_diameter"
			value="0.48" />
		<param
			name="joint_blw"
			value="joint_rear_left_wheel" />
		<param
			name="joint_brw"
			value="joint_rear_right_wheel" />
		<param
			name="joint_stw"
			value="joint_steer" />

		<remap
			from="cmd_vel"
			to="/carina_controller/cmd_vel" />
	</node>
-->

<!-- 
	<node
		name="carina_controller"
		pkg="pr2_controller_manager"
		type="spawner"
		args="carina_controller"
		respawn="false"
		output="screen"
	>
		<param
			name="type"
			value="lrm_controller/SteeringControllerPlugin" />
		<param
			name="timeout"
			value="5" />
		<param
			name="wheel_diameter"
			value="0.48" />
		<param
			name="joint_blw"
			value="joint_rear_left_wheel" />
		<param
			name="joint_brw"
			value="joint_rear_right_wheel" />
		<param
			name="joint_flw"
			value="joint_front_left_wheel" />
		<param
			name="joint_frw"
			value="joint_front_right_wheel" />
		<param
			name="joint_drw"
			value="joint_steer" />
		<param
			name="joint_flw_dir"
			value="joint_front_left_bar" />
		<param
			name="joint_frw_dir"
			value="joint_front_right_bar" />
		
	</node>
-->

</launch>
